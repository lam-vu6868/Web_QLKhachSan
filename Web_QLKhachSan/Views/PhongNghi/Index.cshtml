@model List<Web_QLKhachSan.Models.Phong>
@{
    ViewBag.Title = "Phòng Nghỉ";
}
<link rel="stylesheet" href="~/assets/css/phong-nghi.css" />

<section class="page-header">
    <div class="container">
        <h1 data-aos="fade-right">Khám Phá Không Gian Nghỉ Dưỡng</h1>
        <p data-aos="fade-left">
            Tìm kiếm và lựa chọn không gian hoàn hảo cho kỳ nghỉ của bạn
        </p>
    </div>
</section>
<main class="main-content-area">
    <div data-aos="zoom-out-up" class="container page-layout">
        <aside class="filter-sidebar">
            <div class="filter-header">
                <h4><i class="fas fa-sliders-h"></i> Bộ Lọc Tìm Kiếm</h4>
                <span class="filter-toggle">
                    <i class="fas fa-chevron-down"></i>
                </span>
            </div>

            <div class="filter-content active">
                <div class="filter-content-inner">
                    <div class="filter-groups-container">
                        <!-- Price Range Filter -->
                        <div class="filter-group">
                            <h5><i class="fas fa-dollar-sign"></i> Khoảng giá (/đêm)</h5>
                            <div class="price-range-slider">
                                <input type="range" min="50" max="500" value="250" class="slider" id="priceRange" />
                                <div class="price-display">
                                    <span>$50</span>
                                    <span>$500</span>
                                </div>
                            </div>
                        </div>

                        <!-- Room Type Filter -->
                        <div class="filter-group">
                            <h5><i class="fas fa-bed"></i> Loại phòng</h5>
                            <div class="checkbox-group">
                                @if (ViewBag.LoaiPhongs != null)
                                {
                                    foreach (var loaiPhong in (List<Web_QLKhachSan.Models.LoaiPhong>)ViewBag.LoaiPhongs)
                                    {
                                        <label>
                                            <input type="checkbox" value="@loaiPhong.LoaiPhongId" name="loaiPhong" />
                                            <span>@loaiPhong.TenLoai</span>
                                        </label>
                                    }
                                }
                            </div>
                        </div>

                        <!-- Amenities Filter -->
                        <div class="filter-group">
                            <h5><i class="fas fa-concierge-bell"></i> Tiện ích</h5>
                            <div class="checkbox-group">
                                @if (ViewBag.TienIches != null)
                                {
                                    foreach (var tienIch in (List<Web_QLKhachSan.Models.TienIch>)ViewBag.TienIches)
                                    {
                                        <label>
                                            <input type="checkbox" value="@tienIch.TienIchId" name="tienIch" />
                                            <span>@tienIch.TenTienIch</span>
                                        </label>
                                    }
                                }
                            </div>
                        </div>

                        <button class="filter-apply-btn">
                            <i class="fas fa-search"></i>
                            Áp dụng bộ lọc
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <section class="room-listing-area">
            <div class="listing-header">
                <p>Hiển thị <strong>@(Model?.Count ?? 0)</strong> phòng nghỉ tuyệt vời</p>
                <select name="sort" id="sort">
                    <option value="default">Sắp xếp mặc định</option>
                    <option value="price-asc">Giá: Thấp đến Cao</option>
                    <option value="price-desc">Giá: Cao đến Thấp</option>
                    <option value="rating">Đánh giá cao nhất</option>
                    <option value="newest">Mới nhất</option>
                </select>
            </div>

            <div class="room-listing-grid">
                @if (Model != null && Model.Any())
                {
                    foreach (var phong in Model)
                    {
                        <div class="room-item">
                            <div class="room-item-image">
                                @if (!string.IsNullOrEmpty(phong.HinhAnhThumb))
                                {
                                    <img src="@phong.HinhAnhThumb" alt="@phong.TenPhong" />
                                }
                                else if (phong.PhongAnhs != null && phong.PhongAnhs.Any())
                                {
                                    <img src="@phong.PhongAnhs.FirstOrDefault().Url" alt="@phong.TenPhong" />
                                }
                                else
                                {
                                    <img src="https://images.unsplash.com/photo-1611892440504-42a792e24d32?auto=format&fit=crop&w=870&q=80" alt="@phong.TenPhong" />
                                }
                                <div class="tag">@phong.LoaiPhong.TenLoai</div>
                            </div>
                            <div class="room-item-content">
                                <h3>@phong.TenPhong</h3>
                                <p class="price">$@((phong.Gia ?? phong.LoaiPhong.GiaCoBan ?? 0).ToString("0")) <span>/ đêm</span></p>
                                <p class="description">
                                    @(phong.LoaiPhong.MoTa ?? "Phòng nghỉ thoải mái với đầy đủ tiện nghi hiện đại.")
                                    @if (phong.LoaiPhong.DienTich.HasValue)
                                    {
                                        <span>Diện tích: @phong.LoaiPhong.DienTich m².</span>
                                    }
                                    @if (phong.LoaiPhong.SoNguoiToiDa.HasValue)
                                    {
                                        <span>Tối đa @phong.LoaiPhong.SoNguoiToiDa người.</span>
                                    }
                                </p>
                                <div class="amenities-icons">
                                    @if (phong.LoaiPhong.TienIches != null && phong.LoaiPhong.TienIches.Any())
                                    {
                                        foreach (var tienIch in phong.LoaiPhong.TienIches.Take(5))
                                        {
                                            if (!string.IsNullOrEmpty(tienIch.Icon))
                                            {
                                                <i class="@tienIch.Icon" title="@tienIch.TenTienIch"></i>
                                            }
                                            else
                                            {
                                                <i class="fas fa-check" title="@tienIch.TenTienIch"></i>
                                            }
                                        }
                                    }
                                    else
                                    {
                                        <i class="fas fa-wifi" title="Wifi miễn phí"></i>
                                        <i class="fas fa-bath" title="Bồn tắm"></i>
                                        <i class="fas fa-tv" title="TV màn hình phẳng"></i>
                                        <i class="fas fa-snowflake" title="Điều hòa"></i>
                                        <i class="fas fa-coffee" title="Minibar"></i>
                                    }
                                </div>
                                <div class="room-actions">
                                    <a href="@Url.Action("Index", "ChiTietPhong", new { id = phong.PhongId })" class="cta-button">Xem Chi Tiết</a>
                                    <div class="booking-btn-wrapper">
                                        <a href="@Url.Action("Index", "ThongTin", new { phongId = phong.PhongId })" class="btn-booking"></a>
                                        <span class="tooltip">Đặt Phòng Ngay</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="no-rooms-message">
                        <p>Hiện tại không có phòng nào khả dụng. Vui lòng quay lại sau.</p>
                    </div>
                }
            </div>

            <div class="pagination">
                <a href="#" class="active">1</a>
                <a href="#">2</a>
                <a href="#">3</a>
                <a href="#">&raquo;</a>
            </div>
        </section>
    </div>
</main>

<script src="~/assets/js/phong-nghi.js"></script>
