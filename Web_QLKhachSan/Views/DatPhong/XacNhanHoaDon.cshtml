@model Web_QLKhachSan.Models.ThongTinDatPhongViewModel
@{
    ViewBag.Title = "X√°c Nh·∫≠n Thanh To√°n";
}
<link rel="stylesheet" href="~/assets/css/dat-phong.css" />

<section class="page-header">
    <div class="container">
        <h1 data-aos="fade-right">Ho√†n T·∫•t ƒê·∫∑t Ch·ªó</h1>
        <p data-aos="fade-left">Qu√° tr√¨nh thanh to√°n c·ªßa b·∫°n ƒë∆∞·ª£c b·∫£o m·∫≠t tuy·ªát ƒë·ªëi</p>
    </div>
</section>

<main class="main-content-area">
    <div class="container checkout-layout">
        <div class="checkout-form-area">
            @{ ViewBag.CurrentStep = 4; }
            @Html.Partial("_CheckoutSteps")
            
            <div class="confirmation-box">
            
            @{
                bool? paymentSuccess = ViewBag.PaymentSuccess as bool?;
                
                // N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu g√¨ (ch∆∞a thanh to√°n), redirect v·ªÅ trang ch·ªß
                if (paymentSuccess == null)
                {
                    Response.Redirect(Url.Action("Index", "Home"));
                    return;
                }
                
                bool isSuccess = paymentSuccess.Value;
            }
            
            @if (isSuccess)
            {
                <div class="confirmation-header success">
                    <div class="confirmation-icon-circle success">
                        <i class="fas fa-check"></i>
                    </div>
                    <h2 class="confirmation-title success">‚úÖ Thanh To√°n Th√†nh C√¥ng!</h2>
                    <p class="confirmation-subtitle">ƒê·∫∑t ph√≤ng c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n</p>
                </div>

                <div class="transaction-info-box">
                    <h3 class="transaction-title">üìã Th√¥ng tin giao d·ªãch</h3>
                    <table class="transaction-table">
                        @if (ViewBag.BookingRef != null)
                        {
                            <tr>
                                <td class="transaction-label">M√£ ƒë·∫∑t ph√≤ng:</td>
                                <td class="transaction-value">@ViewBag.BookingRef</td>
                            </tr>
                        }
                        @if (ViewBag.Amount != null)
                        {
                            <tr>
                                <td class="transaction-label">S·ªë ti·ªÅn:</td>
                                <td class="transaction-value amount">@string.Format("{0:N0}ƒë", ViewBag.Amount)</td>
                            </tr>
                        }
                        @if (ViewBag.TransactionNo != null)
                        {
                            <tr>
                                <td class="transaction-label">M√£ giao d·ªãch:</td>
                                <td class="transaction-value">@ViewBag.TransactionNo</td>
                            </tr>
                        }
                        @if (ViewBag.BankCode != null)
                        {
                            <tr>
                                <td class="transaction-label">Ng√¢n h√†ng:</td>
                                <td class="transaction-value">@ViewBag.BankCode</td>
                            </tr>
                        }
                    </table>
                </div>

                <div class="alert-box info">
                    <p>
                        <i class="fas fa-info-circle"></i> 
                        <strong>L∆∞u √Ω:</strong> Th√¥ng tin chi ti·∫øt ƒë·∫∑t ph√≤ng ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n.
                    </p>
                </div>
            }
            else
            {
                <div class="confirmation-header error">
                    <div class="confirmation-icon-circle error">
                        <i class="fas fa-times"></i>
                    </div>
                    <h2 class="confirmation-title error">‚ùå Thanh To√°n Th·∫•t B·∫°i</h2>
                    <p class="confirmation-subtitle">@ViewBag.ErrorMessage</p>
                </div>

                <div class="alert-box warning">
                    <p>
                        <i class="fas fa-exclamation-triangle"></i> 
                        <strong>Vui l√≤ng:</strong> Th·ª≠ l·∫°i ho·∫∑c li√™n h·ªá v·ªõi ch√∫ng t√¥i ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£.
                    </p>
                </div>
            }

            <div class="confirmation-actions">
                <a href="@Url.Action("Index", "Home")" class="btn-confirmation primary">
                    <i class="fas fa-home"></i> V·ªÅ Trang Ch·ªß
                </a>
                @if (isSuccess)
                {
                    <a href="@Url.Action("Index", "PhongNghi")" class="btn-confirmation success">
                        <i class="fas fa-bed"></i> ƒê·∫∑t Ph√≤ng Ti·∫øp
                    </a>
                }
            </div>
        </div>
    </div>
</main>
